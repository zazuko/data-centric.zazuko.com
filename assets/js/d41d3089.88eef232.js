"use strict";(self.webpackChunkdata_centric_zazuko_com=self.webpackChunkdata_centric_zazuko_com||[]).push([[6008],{7532:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"apis/kopflos/tutorials/create-first-api","title":"Create Your First API","description":"This tutorial will guide you through the process of creating a minimal Kopflos API from scratch. The API will handle GET requests for RDF instances of schema:Person stored in the backing triplestore.","source":"@site/docs/apis/kopflos/tutorials/create-first-api.md","sourceDirName":"apis/kopflos/tutorials","slug":"/apis/kopflos/tutorials/create-first-api","permalink":"/docs/apis/kopflos/tutorials/create-first-api","draft":false,"unlisted":false,"editUrl":"https://github.com/zazuko/data-centric.zazuko.com/tree/main/docs/apis/kopflos/tutorials/create-first-api.md","tags":[],"version":"current","frontMatter":{},"sidebar":"apisSidebar","previous":{"title":"Kopflos","permalink":"/docs/apis/kopflos/"},"next":{"title":"Getting started","permalink":"/docs/apis/kopflos/tutorials/gettings-started"}}');var r=n(4848),o=n(8453);const a={},i="Create Your First API",c={},l=[{value:"Setup",id:"setup",level:2},{value:"Setting Up the Database",id:"setting-up-the-database",level:2},{value:"Creating the Node.js Project",id:"creating-the-nodejs-project",level:2},{value:"The configuration file",id:"the-configuration-file",level:2},{value:"The API description",id:"the-api-description",level:2},{value:"Add resource data",id:"add-resource-data",level:2},{value:"Start it!",id:"start-it",level:2}];function d(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"create-your-first-api",children:"Create Your First API"})}),"\n",(0,r.jsxs)(s.p,{children:["This tutorial will guide you through the process of creating a minimal Kopflos API from scratch. The API will handle GET requests for RDF instances of ",(0,r.jsx)(s.code,{children:"schema:Person"})," stored in the backing triplestore."]}),"\n",(0,r.jsxs)(s.p,{children:["In addition to ",(0,r.jsx)(s.em,{children:"Node.js"}),", you will need ",(0,r.jsx)(s.em,{children:"Docker"})," to set up a local triplestore."]}),"\n",(0,r.jsx)(s.h2,{id:"setup",children:"Setup"}),"\n",(0,r.jsx)(s.p,{children:"First, create a new directory for your project and navigate into it:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mkdir my-api && cd my-api\n"})}),"\n",(0,r.jsx)(s.h2,{id:"setting-up-the-database",children:"Setting Up the Database"}),"\n",(0,r.jsx)(s.p,{children:"Kopflos requires a database (a SPARQL endpoint) to store RDF resources and the API description. We will use Docker Compose to create a local Oxigraph triplestore."}),"\n",(0,r.jsxs)(s.p,{children:["Create a ",(0,r.jsx)(s.code,{children:"docker-compose.yaml"})," file with the following content to:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"services:\n  oxigraph:\n    image: ghcr.io/oxigraph/oxigraph:latest\n    user: root\n    command: serve --location /data --bind 0.0.0.0:7878\n    ports:\n      - 7878:7878\n    volumes:\n      - ./oxigraph:/data\n"})}),"\n",(0,r.jsx)(s.p,{children:"Start the database:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Once the database is running, you can open ",(0,r.jsx)(s.a,{href:"http://localhost:7878",children:"http://localhost:7878"})," to access the database UI."]}),"\n",(0,r.jsx)(s.h2,{id:"creating-the-nodejs-project",children:"Creating the Node.js Project"}),"\n",(0,r.jsxs)(s.p,{children:["Next, we will create the Kopflos API using ",(0,r.jsx)(s.a,{href:"http://nodejs.org/",children:"Node.js"}),"."]}),"\n",(0,r.jsx)(s.p,{children:"Initialize a new Node.js project:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npm init -y\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Edit the file ",(0,r.jsx)(s.code,{children:"package.json"})," created by the above command, and set the ",(0,r.jsx)(s.code,{children:'"type"'})," field to ",(0,r.jsx)(s.code,{children:'"module"'})," :"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'"type": "module"\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Your ",(0,r.jsx)(s.code,{children:"package.json"})," should now look something like this:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:'{\n  "name": "my-api",\n  "type": "module",\n  "version": "1.0.0",\n  "description": "",\n  "main": "index.js",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC"\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Install ",(0,r.jsx)(s.code,{children:"kopflos"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npm install kopflos\n"})}),"\n",(0,r.jsx)(s.h2,{id:"the-configuration-file",children:"The configuration file"}),"\n",(0,r.jsxs)(s.p,{children:["Create a Kopflos ",(0,r.jsx)(s.a,{href:"../reference/configuration",children:"configuration file"})," ",(0,r.jsx)(s.code,{children:"kopflos.config.js"})," with the following content to ",(0,r.jsx)(s.code,{children:"kopflos.config.js"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"export default {\n  baseIri: 'http://localhost:1429',\n  apiGraphs: ['http://localhost:1429/api'],\n  sparql: {\n    default: {\n      endpointUrl: 'http://localhost:7878/query?union-default-graph',\n      updateUrl: 'http://localhost:7878/update',\n    },\n  },\n  plugins: {\n    '@kopflos-cms/plugin-deploy-resources': {\n      paths: ['resources'],\n    },\n  },\n}\n"})}),"\n",(0,r.jsxs)(s.p,{children:["This configuration tells Kopflos about the SPARQL endpoint and specifies that RDF files in the ",(0,r.jsx)(s.code,{children:"resources"})," directory should be loaded into the triplestore at startup (see ",(0,r.jsx)(s.a,{href:"/docs/apis/kopflos/how-to/seed-database",children:"Seed database on app start"}),")."]}),"\n",(0,r.jsxs)(s.p,{children:["If we create a file named ",(0,r.jsx)(s.code,{children:"api.ttl"})," in the ",(0,r.jsx)(s.code,{children:"resources"})," directory, Kopflos will load its contents at startup into the named graph ",(0,r.jsx)(s.code,{children:"http://localhost:1429/api"}),", which is where the API description should be according to the value of ",(0,r.jsx)(s.code,{children:"apiGraphs"}),"."]}),"\n",(0,r.jsx)(s.p,{children:"Let's create this file."}),"\n",(0,r.jsx)(s.h2,{id:"the-api-description",children:"The API description"}),"\n",(0,r.jsxs)(s.p,{children:["Create the ",(0,r.jsx)(s.code,{children:"resources"})," directory and a ",(0,r.jsx)(s.code,{children:"api.ttl"})," file within:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-turtle",children:"@prefix schema: <http://schema.org/> .\n@prefix sh: <http://www.w3.org/ns/shacl#> .\n@prefix kl: <https://kopflos.described.at/> .\n\n<>\n  a kl:Api ;\n  kl:resourceLoader kl:OwnGraphLoader ;\n.\n\n<#person>\n  a kl:ResourceShape ;\n  kl:api <> ;\n  sh:targetClass schema:Person ;\n.\n"})}),"\n",(0,r.jsxs)(s.p,{children:["The API description above ensures that instances of ",(0,r.jsx)(s.code,{children:"schema:Person"})," are\nrecognized as API resources (see ",(0,r.jsx)(s.a,{href:"../reference/request-handlers",children:"Request Handlers"}),"),\nand their core representation is the contents of the named graph identified by the resource URI (see ",(0,r.jsx)(s.a,{href:"../how-to/resource-loaders",children:"Resource Loaders"}),")."]}),"\n",(0,r.jsx)(s.h2,{id:"add-resource-data",children:"Add resource data"}),"\n",(0,r.jsxs)(s.p,{children:["In the ",(0,r.jsx)(s.code,{children:"resources"})," folder we can add also resource data.\nLet's add a file for a person named Alice in a ",(0,r.jsx)(s.code,{children:"people"})," subdirectory. We'll call it ",(0,r.jsx)(s.code,{children:"resources/people/p1.ttl"}),"."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-turtle",children:'@prefix schema: <http://schema.org/> .\n\n<> a schema:Person ;\n    schema:name "Alice" .\n'})}),"\n",(0,r.jsx)(s.h2,{id:"start-it",children:"Start it!"}),"\n",(0,r.jsx)(s.p,{children:"You can finally start kopflos:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx kopflos serve\n"})}),"\n",(0,r.jsx)(s.p,{children:"You should see some log messages, the last one similar to:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Server running on 1429. API URL: http://localhost:1429 \n"})}),"\n",(0,r.jsxs)(s.p,{children:["Opening ",(0,r.jsx)(s.a,{href:"http://localhost:1429/people/p1",children:"http://localhost:1429/people/p1"})," you should see the RDF data for Alice:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'[\n  {\n    "@id": "http://localhost:1429/people/p1",\n    "@type": "http://schema.org/Person"\n  },\n  {\n    "@id": "http://localhost:1429/people/p1",\n    "http://schema.org/name": "Alice"\n  }\n]\n'})}),"\n",(0,r.jsxs)(s.p,{children:["The response is serialized as JSON-LD. To request another format you can use ",(0,r.jsx)(s.code,{children:"curl"}),"\nwith a proper accept header:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'curl --header "Accept: text/turtle" http://localhost:1429/people/p1\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Congratulations! You have successfully created your first Kopflos API. You can now handle GET requests for RDF instances of ",(0,r.jsx)(s.code,{children:"schema:Person"})," stored in your triplestore. Happy coding!"]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>i});var t=n(6540);const r={},o=t.createContext(r);function a(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(o.Provider,{value:s},e.children)}}}]);