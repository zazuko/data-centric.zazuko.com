"use strict";(self.webpackChunkdata_centric_zazuko_com=self.webpackChunkdata_centric_zazuko_com||[]).push([[3930],{3620:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"apis/kopflos/how-to/patterned-target","title":"Serve virtual resources","description":"In addition to shtargetClass, a specialised target can be used to match","source":"@site/docs/apis/kopflos/how-to/patterned-target.md","sourceDirName":"apis/kopflos/how-to","slug":"/apis/kopflos/how-to/patterned-target","permalink":"/docs/apis/kopflos/how-to/patterned-target","draft":false,"unlisted":false,"editUrl":"https://github.com/zazuko/data-centric.zazuko.com/tree/main/docs/apis/kopflos/how-to/patterned-target.md","tags":[],"version":"current","frontMatter":{},"sidebar":"apisSidebar","previous":{"title":"Implement parametrised handlers","permalink":"/docs/apis/kopflos/how-to/parametrised-handlers"},"next":{"title":"Configure resource loaders","permalink":"/docs/apis/kopflos/how-to/resource-loaders"}}');var a=n(4848),o=n(8453);const s={},c="Serve virtual resources",i={},d=[];function l(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"serve-virtual-resources",children:"Serve virtual resources"})}),"\n",(0,a.jsxs)(t.p,{children:["In addition to ",(0,a.jsx)(t.code,{children:"sh:targetNode"})," and ",(0,a.jsx)(t.code,{children:"sh:targetClass"}),", a specialised target can be used to match\nresources based on URL patterns. Such resources do not have to exist as triples in the database\nbut can be generated on-the-fly by the server."]}),"\n",(0,a.jsxs)(t.p,{children:["For example, if you have a collection resource, such as ",(0,a.jsx)(t.code,{children:"http://example.org/projects"}),", and you would\nlike to implement pagination using URL query parameters, you can define a patterned target to match\nrequests to ",(0,a.jsx)(t.code,{children:"http://example.org/projects/1"}),", ",(0,a.jsx)(t.code,{children:"http://example.org/projects/2"}),", etc."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-turtle",children:'PREFIX code: <https://code.described.at/>\nPREFIX sh: <http://www.w3.org/ns/shacl#>\nPREFIX kl: <https://kopflos.described.at/>\n\n[\n  a kl:ResourceShape ;\n  sh:target\n    [\n      a kl:PatternedTarget ;\n      # Capture the page number in the URL\n      kl:regex "/projects(/(?<page>\\\\d+))?" ;\n    ] ;\n  kl:handler\n    [\n      a kl:Handler ;\n      kl:method "GET" ;\n      code:implementedBy\n        [\n          a code:EcamScriptModule ;\n          code:link <file:handler/projects.js#getCollection> ;\n          # Pass the page number as an argument to the handler\n          code:arguments ( "${page}"^^code:EcmaScriptTemplateLiteral ) ;\n        ] ;\n    ] ;\n] .\n'})}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsx)(t.p,{children:"The pattern is matched against the path part of the URL only."})}),"\n",(0,a.jsxs)(t.p,{children:["By taking advantage of named capture groups in the regular expression, you can extract parts of the\nURL. They can also be accessed programmatically from ",(0,a.jsx)(t.code,{children:"subjectVariables"})," in a handler."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:"import { Handler } from '@kopflos-cms/core'\n\nexport function getCollection (page: string): Handler {\n  return ({ subjectVariables }) => {\n    // subjectVariables.page === page\n  }\n}\n"})}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsxs)(t.p,{children:["Currently only regular expression patterns are supported. In a future release support for\n",(0,a.jsx)(t.a,{href:"https://datatracker.ietf.org/doc/html/rfc6570",children:"RFC6570 URI templates"})," and express-style will be\nadded."]})})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>c});var r=n(6540);const a={},o=r.createContext(a);function s(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);