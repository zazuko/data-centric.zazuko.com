"use strict";(self.webpackChunkdata_centric_zazuko_com=self.webpackChunkdata_centric_zazuko_com||[]).push([[9168],{8378:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"apis/kopflos/reference/request-handlers","title":"Request handlers","description":"Depending on the kind of Resource Shape matched to the request, different arguments will be passed","source":"@site/docs/apis/kopflos/reference/request-handlers.md","sourceDirName":"apis/kopflos/reference","slug":"/apis/kopflos/reference/request-handlers","permalink":"/docs/apis/kopflos/reference/request-handlers","draft":false,"unlisted":false,"editUrl":"https://github.com/zazuko/data-centric.zazuko.com/tree/main/docs/apis/kopflos/reference/request-handlers.md","tags":[],"version":"current","frontMatter":{},"sidebar":"apisSidebar","previous":{"title":"Configuration","permalink":"/docs/apis/kopflos/reference/configuration"}}');var t=s(4848),a=s(8453);const c={},o="Request handlers",l={},d=[{value:"Subject handlers",id:"subject-handlers",level:2},{value:"Object handlers",id:"object-handlers",level:2},{value:"Subject variables",id:"subject-variables",level:2}];function i(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"request-handlers",children:"Request handlers"})}),"\n",(0,t.jsx)(n.p,{children:"Depending on the kind of Resource Shape matched to the request, different arguments will be passed\nto the handler."}),"\n",(0,t.jsx)(n.h2,{id:"subject-handlers",children:"Subject handlers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-turtle",children:"PREFIX kl: <https://kopflos.described.at/>\nPREFIX sh: <http://www.w3.org/ns/shacl#>\n\n<#plaque>\n  a kl:ResourceShape ;\n  kl:api <> ;\n  sh:targetClass </api/schema/Plaque> ;\n.\n\n<#about>\n  a kl:ResourceShape ;\n  kl:api <> ;\n  sh:targetNode </about-page.html> ;\n.\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The most common kind of request, when a resource is matched by its URL (",(0,t.jsx)(n.code,{children:"sh:targetNode"}),") or class (\n",(0,t.jsx)(n.code,{children:"sh:targetClass"}),")."]}),"\n",(0,t.jsx)(n.p,{children:"Such handlers will receive as the first argument an object in the form of this interface."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"interface SubjectHandlerArgs {\n  resourceShape: GraphPointer<NamedNode, D>\n  env: KopflosEnvironment\n  subject: GraphPointer<NamedNode, D>\n  subjectVariables: Record<string, string>\n  body: Body<D>\n  query: Query\n  headers: IncomingHttpHeaders\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"object-handlers",children:"Object handlers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-turtle",children:'PREFIX sh: <http://www.w3.org/ns/shacl#>\nPREFIX kl: <https://kopflos.described.at/>\n\n<#plaque>\n  a kl:ResourceShape ;\n  kl:api <> ;\n  sh:property\n    [\n      sh:path </api/schema/tags> ;\n      kl:handler\n        [\n          a kl:Handler ;\n          kl:method "GET" ;\n          # ...\n        ] ;\n    ] ;\n.\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Requests matched to objects by following resource shape properties additionally receive the\n",(0,t.jsx)(n.code,{children:"predicate"})," and the ",(0,t.jsx)(n.code,{children:"object"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"interface ObjectHandlerArgs extends SubjectHandlerArgs {\n  property: NamedNode\n  object: GraphPointer<NamedNode, D>\n}\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["Note that the ",(0,t.jsx)(n.code,{children:"object"})," is the requested resource and the ",(0,t.jsx)(n.code,{children:"subject"})," is the subject in the respective triple.\nThis differs from subject handlers where the ",(0,t.jsx)(n.code,{children:"subject"})," is the requested resource."]})}),"\n",(0,t.jsx)(n.h2,{id:"subject-variables",children:"Subject variables"}),"\n",(0,t.jsxs)(n.p,{children:["Requests matched to a patterned target will fill the ",(0,t.jsx)(n.code,{children:"subjectVariables"})," with values extracted from the URL pattern."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-turtle",children:'PREFIX sh: <http://www.w3.org/ns/shacl#>\nPREFIX kl: <https://kopflos.described.at/>\n\n<person-page>\n  a kl:ResourceShape ;\n  kl:api <> ;\n  sh:target\n    [\n      a kl:PatternedTarget ;\n      kl:regex "/page/person/(?<id>.+)$" ;\n    ] ;\n.\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Requesting ",(0,t.jsx)(n.code,{children:"/page/person/123/abc"})," will result in the following ",(0,t.jsx)(n.code,{children:"subjectVariables"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "123/abc"\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(i,{...e})}):i(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>o});var r=s(6540);const t={},a=r.createContext(t);function c(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);